<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" id="meta-app-title" content="ì‚¬ì—°í•¨">
<meta name="theme-color" id="meta-theme-color" content="#8b65cc">
<link rel="manifest" href="/manifest.json">
<link rel="apple-touch-icon" href="/icon-192.png">
<title id="page-title">ì‚¬ì—° ë³´ë‚´ê¸°</title>
<link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&family=Noto+Sans+KR:wght@300;400;500&display=swap" rel="stylesheet">
<style>
/* â”€â”€â”€ CSS ë³€ìˆ˜ (JSì—ì„œ ë®ì–´ì”€) â”€â”€â”€ */
:root {
  --c1: #8b65cc;      /* ì£¼ìƒ‰ */
  --c1-light: #b08ee0;
  --c1-pale: #f8f4ff;
  --c1-rgb: 139,101,204;
  --ink: #2d2040;
  --muted: #8a7fa8;
  --border: #e2d8f5;
  --card: rgba(255,255,255,0.90);
}

*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{
  font-family:'Noto Sans KR',sans-serif;
  background:#ffffff;
  color:var(--ink);
  min-height:100vh;
  position:relative;
}

/* ë°°ê²½ ë ˆì´ì–´ */
body::before {
  content:'';
  position:fixed; inset:0; z-index:0; pointer-events:none;
  background:
    radial-gradient(ellipse 80% 60% at 10% 5%, rgba(var(--c1-rgb),0.07) 0%, transparent 60%),
    radial-gradient(ellipse 60% 50% at 90% 90%, rgba(var(--c1-rgb),0.05) 0%, transparent 50%);
}
body::after {
  content:''; position:fixed; inset:0; z-index:0; pointer-events:none;
  background:rgba(255,255,255,0.12);
}

.site-header,.hero,.form-wrap,.toast{position:relative;z-index:1;}

/* â”€â”€â”€ í—¤ë” â”€â”€â”€ */
.site-header{
  padding:3.5rem 2rem 0;
  display:flex; align-items:center; justify-content:space-between;
}
.radio-badge{
  display:flex; align-items:center; gap:0.6rem;
  font-size:0.78rem; color:var(--muted);
  letter-spacing:0.12em; text-transform:uppercase;
}
.dot{
  width:8px; height:8px; background:var(--c1);
  border-radius:50%; animation:pulse 2s infinite;
}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.8)}}

/* ì±„ë„ ë±ƒì§€ */
.channel-badge{
  font-size:0.72rem; font-weight:600; letter-spacing:0.08em;
  padding:0.2rem 0.7rem; border-radius:20px;
  background:rgba(var(--c1-rgb),0.1); color:var(--c1);
  border:1px solid rgba(var(--c1-rgb),0.2);
}

/* â”€â”€â”€ íˆì–´ë¡œ â”€â”€â”€ */
.hero{text-align:center;padding:3rem 2rem 1.8rem;position:relative;}
.hero::before{
  content:'â™ª'; position:absolute; top:2rem; left:8%;
  font-size:4rem; color:rgba(var(--c1-rgb),0.06);
  animation:float 6s ease-in-out infinite;
}
.hero::after{
  content:'â™©'; position:absolute; top:2.5rem; right:10%;
  font-size:3rem; color:rgba(var(--c1-rgb),0.06);
  animation:float 8s ease-in-out infinite reverse;
}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}

.hero-label{
  font-size:0.74rem; letter-spacing:0.22em; text-transform:uppercase;
  color:var(--c1); margin-bottom:0.9rem; font-weight:600;
}
.hero h1{
  font-family:'Nanum Myeongjo',serif;
  font-size:clamp(1.85rem,5.5vw,3rem);
  font-weight:800; color:var(--ink); line-height:1.35;
  margin-bottom:0.9rem;
}
.hero h1 em{font-style:normal; color:var(--c1);}
.hero p{
  font-size:0.95rem; color:var(--muted); line-height:1.85;
  max-width:400px; margin:0 auto;
}

/* â”€â”€â”€ í¼ â”€â”€â”€ */
.form-wrap{max-width:620px;margin:0 auto;padding:0 1.5rem 4rem;}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px; padding:2rem;
  margin-bottom:1rem;
  box-shadow:0 2px 20px rgba(var(--c1-rgb),0.07);
  transition:box-shadow 0.3s;
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
}
.card:hover{box-shadow:0 4px 28px rgba(var(--c1-rgb),0.13);}

.card-title{
  font-family:'Nanum Myeongjo',serif;
  font-size:1rem; font-weight:700; color:var(--c1);
  margin-bottom:1.2rem;
  display:flex; align-items:center; gap:0.5rem;
}

.row2{display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;}
.field{margin-bottom:0.9rem;}
.field:last-child{margin-bottom:0;}
.field label{
  display:block; font-size:0.8rem; color:var(--muted);
  margin-bottom:0.35rem; font-weight:500;
}
input[type="text"],textarea{
  width:100%; background:#fff;
  border:1.5px solid var(--border);
  border-radius:10px; padding:0.75rem 1rem;
  color:var(--ink); font-family:'Noto Sans KR',sans-serif;
  font-size:0.92rem; outline:none;
  transition:border-color 0.25s,box-shadow 0.25s;
}
input[type="text"]:focus,textarea:focus{
  border-color:var(--c1);
  box-shadow:0 0 0 3px rgba(var(--c1-rgb),0.1);
}
textarea{min-height:180px;resize:vertical;line-height:1.75;}

/* â”€â”€â”€ íƒœê·¸ â”€â”€â”€ */
.tag-grid{display:flex;flex-wrap:wrap;gap:0.45rem;}
.tag{
  padding:0.35rem 0.85rem; border-radius:20px;
  border:1.5px solid var(--border); background:#fff;
  color:var(--muted); font-size:0.82rem; cursor:pointer;
  transition:all 0.2s; user-select:none;
}
.tag:hover{border-color:var(--c1-light);color:var(--c1);}
.tag.active{background:var(--c1);border-color:var(--c1);color:#fff;}

/* â”€â”€â”€ ìŒì„± ì„¹ì…˜ â”€â”€â”€ */
.voice-inner{
  background:#fff; border:1.5px dashed var(--border);
  border-radius:12px; padding:1.5rem; text-align:center;
}
.voice-hint{font-size:0.82rem;color:var(--muted);margin-bottom:1rem;line-height:1.6;}
.voice-controls{
  display:flex;align-items:center;justify-content:center;
  gap:0.7rem;flex-wrap:wrap;
}
.btn{
  display:inline-flex;align-items:center;gap:0.4rem;
  padding:0.65rem 1.4rem;border-radius:10px;
  border:1.5px solid transparent;
  font-family:'Noto Sans KR',sans-serif;
  font-size:0.88rem;cursor:pointer;transition:all 0.2s;font-weight:500;
}
.btn-main{background:var(--c1);color:#fff;}
.btn-main:hover{filter:brightness(0.9);transform:translateY(-1px);}
.btn-main.recording{animation:recPulse 1s infinite;}
@keyframes recPulse{
  0%,100%{box-shadow:0 0 0 0 rgba(var(--c1-rgb),0.5)}
  50%{box-shadow:0 0 0 10px rgba(var(--c1-rgb),0)}
}
.btn-outline{background:#fff;border-color:var(--border);color:var(--muted);}
.btn-outline:hover{border-color:var(--c1-light);color:var(--c1);}
.btn:disabled{opacity:0.4;cursor:not-allowed;transform:none!important;}
.rec-timer{font-size:0.9rem;font-weight:700;color:var(--c1);display:none;min-width:48px;}
audio{width:100%;border-radius:8px;margin-top:1rem;}

.upload-zone{
  margin-top:0.8rem; border:1.5px dashed var(--border);
  border-radius:10px; padding:1rem; text-align:center;
  cursor:pointer; transition:all 0.2s;
}
.upload-zone:hover{border-color:var(--c1-light);background:rgba(var(--c1-rgb),0.02);}
.upload-zone input{display:none;}
.upload-zone p{font-size:0.82rem;color:var(--muted);}
.fname{color:var(--c1);margin-top:0.3rem;font-size:0.82rem;}

/* â”€â”€â”€ ì œì¶œ ë²„íŠ¼ â”€â”€â”€ */
.submit-btn{
  width:100%; padding:1.1rem;
  background:var(--c1); color:#fff; border:none;
  border-radius:14px; font-family:'Nanum Myeongjo',serif;
  font-size:1.1rem; font-weight:700; cursor:pointer;
  transition:all 0.3s; margin-top:0.5rem;
  display:flex;align-items:center;justify-content:center;
  gap:0.5rem; letter-spacing:0.05em;
}
.submit-btn:hover{
  filter:brightness(0.9);transform:translateY(-2px);
  box-shadow:0 8px 24px rgba(var(--c1-rgb),0.32);
}
.submit-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;box-shadow:none;}

/* â”€â”€â”€ ì„±ê³µ í™”ë©´ â”€â”€â”€ */
.success-screen{
  display:none;text-align:center;
  padding:5rem 2rem;max-width:480px;margin:0 auto;
}
.success-icon{font-size:4rem;margin-bottom:1.5rem;}
.success-screen h2{
  font-family:'Nanum Myeongjo',serif;font-size:2rem;
  font-weight:800;color:var(--ink);margin-bottom:1rem;
}
.success-screen p{
  font-size:1rem;color:var(--muted);line-height:1.9;
}

/* â”€â”€â”€ í† ìŠ¤íŠ¸ â”€â”€â”€ */
.toast{
  position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(20px);
  background:rgba(30,20,50,0.88);color:#fff;
  padding:0.8rem 1.5rem;border-radius:50px;
  font-size:0.88rem;opacity:0;transition:all 0.3s;pointer-events:none;z-index:9999;
  white-space:nowrap;
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}

/* ìŠ¤í”¼ë„ˆ */
.spinner{
  width:16px;height:16px;
  border:2px solid rgba(255,255,255,0.3);
  border-top-color:#fff;border-radius:50%;
  animation:spin 0.7s linear infinite;display:inline-block;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* â”€â”€â”€ ì„¤ì¹˜ íŒì—… â”€â”€â”€ */
#install-guide{
  position:fixed;inset:0;z-index:1000;
  background:rgba(0,0,0,0.5);
  display:flex;align-items:flex-end;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity 0.3s;
}
#install-guide.show{opacity:1;pointer-events:auto;}
.install-card{
  background:#fff;border-radius:24px 24px 0 0;
  padding:2rem 1.5rem 2.5rem;width:100%;max-width:480px;
  transform:translateY(100%);transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
#install-guide.show .install-card{transform:translateY(0);}
.install-card h3{font-family:'Nanum Myeongjo',serif;font-size:1.2rem;font-weight:800;color:var(--ink);margin-bottom:0.4rem;}
.install-card .sub{font-size:0.82rem;color:var(--muted);text-align:center;margin-bottom:1.5rem;}
.install-steps{display:flex;flex-direction:column;gap:0.9rem;margin-bottom:1.5rem;}
.install-step{
  display:flex;align-items:center;gap:0.9rem;
  background:var(--c1-pale);border-radius:12px;padding:0.8rem 1rem;
}
.step-num{
  width:28px;height:28px;min-width:28px;
  background:var(--c1);color:#fff;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:0.78rem;font-weight:700;
}
.step-text{font-size:0.85rem;color:var(--ink);line-height:1.4;}
.step-text strong{color:var(--c1);}
.install-tabs{display:flex;gap:0.5rem;margin-bottom:1.2rem;}
.install-tab{
  flex:1;padding:0.5rem;border:2px solid var(--border);border-radius:10px;
  background:#fff;color:var(--muted);font-size:0.8rem;font-weight:600;
  cursor:pointer;transition:all 0.2s;
}
.install-tab.active{border-color:var(--c1);background:rgba(var(--c1-rgb),0.07);color:var(--c1);}
.install-close{
  width:100%;padding:0.9rem;background:var(--c1);color:#fff;
  border:none;border-radius:50px;font-size:0.95rem;font-weight:700;cursor:pointer;
}
.install-close:hover{filter:brightness(0.9);}
.install-skip{
  display:block;text-align:center;margin-top:0.8rem;
  font-size:0.78rem;color:var(--muted);cursor:pointer;text-decoration:underline;
}

/* ë°˜ì‘í˜• */
@media(max-width:480px){
  .row2{grid-template-columns:1fr;}
  .hero h1{font-size:1.75rem;}
}
</style>
</head>
<body>

<header class="site-header">
  <div class="radio-badge">
    <span class="dot"></span>
    <span>ON AIR</span>
  </div>
  <div class="channel-badge" id="channel-badge"></div>
</header>

<section class="hero">
  <p class="hero-label" id="hero-label">Radio Story</p>
  <h1 id="hero-title">ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼<br><em id="hero-em">ë“¤ë ¤ì£¼ì„¸ìš”</em></h1>
  <p id="hero-desc">ì†Œì¤‘í•œ ì‚¬ì—°ì„ í…ìŠ¤íŠ¸ë‚˜ ìŒì„±ìœ¼ë¡œ ë³´ë‚´ì£¼ì„¸ìš”.<br>ë°©ì†¡ì—ì„œ ì—¬ëŸ¬ë¶„ì˜ ëª©ì†Œë¦¬ë¥¼ ì „í•˜ê² ìŠµë‹ˆë‹¤.</p>
</section>

<div class="form-wrap">
  <div id="form-body">

    <div class="card">
      <div class="card-title">ğŸ‘¤ ë³´ë‚´ëŠ” ë¶„</div>
      <div class="row2">
        <div class="field">
          <label id="label-name">ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„</label>
          <input type="text" id="f-name" placeholder="ìµëª…ë„ ê´œì°®ì•„ìš”">
        </div>
        <div class="field">
          <label>ì—°ë½ì²˜ (ì„ íƒ)</label>
          <input type="text" id="f-contact" placeholder="ì´ë©”ì¼ ë˜ëŠ” ì „í™”ë²ˆí˜¸">
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title" id="tag-card-title">ğŸ·ï¸ ì‚¬ì—° ë¶„ë¥˜</div>
      <div class="field">
        <label>ì¹´í…Œê³ ë¦¬</label>
        <div class="tag-grid" id="cat-tags"></div>
      </div>
      <div class="field" style="margin-top:1rem;">
        <label>ì§€ê¸ˆ ë§ˆìŒ (ë³µìˆ˜ ì„ íƒ)</label>
        <div class="tag-grid" id="emo-tags"></div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">âœï¸ <span id="text-card-title">í…ìŠ¤íŠ¸ ì‚¬ì—°</span></div>
      <textarea id="f-text" spellcheck="true" lang="ko" id="f-text-area"></textarea>
    </div>

    <div class="card">
      <div class="card-title">ğŸ™ï¸ ìŒì„± ì‚¬ì—°</div>
      <div class="voice-inner">
        <p class="voice-hint">ğŸ™ï¸ ìŒì„± ë…¹ìŒ ë˜ëŠ” ğŸ“ ë°›ì•„ì“°ê¸° ì¤‘ ì„ íƒí•˜ì„¸ìš”</p>
        <div style="display:flex;flex-direction:column;gap:0.8rem;width:100%;">
          <div style="background:rgba(var(--c1-rgb),0.04);border:1px solid rgba(var(--c1-rgb),0.18);border-radius:10px;padding:1rem;">
            <div style="font-size:0.78rem;color:var(--c1);font-weight:700;margin-bottom:0.6rem;">ğŸ™ï¸ ìŒì„± ë…¹ìŒ (íŒŒì¼ë¡œ ì €ì¥)</div>
            <div class="voice-controls">
              <button class="btn btn-main" id="rec-btn" onclick="toggleRec()">ğŸ™ï¸ <span id="rec-label">ë…¹ìŒ ì‹œì‘</span></button>
              <span class="rec-timer" id="rec-timer">00:00</span>
            </div>
            <div id="audio-preview"></div>
          </div>
          <div style="background:rgba(0,0,0,0.02);border:1px solid var(--border);border-radius:10px;padding:1rem;">
            <div style="font-size:0.78rem;color:var(--muted);font-weight:700;margin-bottom:0.6rem;">ğŸ“ ë°›ì•„ì“°ê¸° (í…ìŠ¤íŠ¸ë¡œ ë³€í™˜)</div>
            <div class="voice-controls">
              <button class="btn btn-outline" id="stt-btn" onclick="toggleSTT()">ğŸ¤ <span id="stt-label">ë°›ì•„ì“°ê¸° ì‹œì‘</span></button>
              <span class="rec-timer" id="stt-timer" style="color:var(--muted);display:none;">00:00</span>
            </div>
            <p id="stt-status" style="font-size:0.78rem;color:var(--muted);margin-top:0.5rem;text-align:center;min-height:1.2rem;"></p>
          </div>
        </div>
      </div>
      <div class="upload-zone" onclick="document.getElementById('vfile').click()">
        <input type="file" id="vfile" accept="audio/*" onchange="handleFile(this)">
        <p>ğŸ“ ìŒì„± íŒŒì¼ ì²¨ë¶€ (.mp3 .wav .m4a .ogg)</p>
        <p class="fname" id="fname"></p>
      </div>
    </div>

    <button class="submit-btn" id="submit-btn" onclick="submitStory()">
      <span id="submit-label">ì‚¬ì—° ì „ì†¡í•˜ê¸°</span> âœ‰ï¸
    </button>

  </div>

  <div class="success-screen" id="success-screen">
    <div class="success-icon" id="success-icon">ğŸ“»</div>
    <h2 id="success-title">ì‚¬ì—°ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤</h2>
    <p id="success-desc">ì†Œì¤‘í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.<br>ë°©ì†¡ì—ì„œ ì†Œê°œë  ìˆ˜ ìˆìœ¼ë‹ˆ ê¸°ëŒ€í•´ ì£¼ì„¸ìš” ğŸ¶</p>
    <br>
    <button class="btn btn-outline" style="margin:0 auto;" onclick="resetForm()">
      ìƒˆ ì‚¬ì—° ë³´ë‚´ê¸°
    </button>
  </div>
</div>

<div class="toast" id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     íƒ€ì…ë³„ ì„¤ì • (JSON)
     ê° íƒ€ì…ì€ ì™„ì „íˆ ë…ë¦½ì ì¸ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
const TYPES = {

  /* â”€â”€ ì¥ì• ì¸ ë‹¹ì‚¬ì â”€â”€ */
  self: {
    appName: 'ë‚˜ì˜ ì´ì•¼ê¸°',
    channel: 'ì¥ì• ì¸ ì‚¬ì—° ì±„ë„',
    themeColor: '#6e5abf',
    c1: '#6e5abf',
    c1Light: '#9b8ad6',
    c1Pale: '#f2eefc',
    c1Rgb: '110,90,191',
    ink: '#2a1e50',
    muted: '#7a6fa8',
    border: '#ddd6f5',

    heroLabel: 'My Story',
    heroTitle: 'ë‚´ ì´ì•¼ê¸°ë¥¼',
    heroEm: 'ë“¤ì–´ì£¼ì„¸ìš”',
    heroDesc: 'ì‚´ì•„ê°€ë©´ì„œ ê²ªì€ ë‚˜ë§Œì˜ ì´ì•¼ê¸°ë¥¼\ní…ìŠ¤íŠ¸ë‚˜ ìŒì„±ìœ¼ë¡œ ë³´ë‚´ì£¼ì„¸ìš”.',

    channel_badge: 'ë‚˜ì˜ ì´ì•¼ê¸°',
    name_label: 'ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„',
    tag_card_title: 'ğŸ·ï¸ ì´ì•¼ê¸° ë¶„ë¥˜',
    text_placeholder: 'ì‚´ë©´ì„œ ê²ªì€ ì´ì•¼ê¸°, í•˜ê³  ì‹¶ì€ ë§, ì†Œë§... ë­ë“  ê´œì°®ì•„ìš”.\n\nì–´ë–¤ ì´ì•¼ê¸°ë“  ì†Œì¤‘íˆ ì „í•˜ê² ìŠµë‹ˆë‹¤.',
    submit_label: 'ì´ì•¼ê¸° ì „ì†¡í•˜ê¸°',
    success_icon: 'ğŸ“»',
    success_title: 'ì´ì•¼ê¸°ê°€ ë„ì°©í–ˆì–´ìš”',
    success_desc: 'ìš©ê¸° ë‚´ì–´ ë³´ë‚´ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.\nì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ë¥¼ ë°©ì†¡ì—ì„œ ì†Œì¤‘íˆ ì „í• ê²Œìš” ğŸ¶',

    categories: [
      'ğŸ’ª ë‚˜ì˜ ì¼ìƒ', 'ğŸŒˆ ê¿ˆê³¼ ë°”ëŒ', 'ğŸ¤ ì‚¬ëŒê³¼ ê´€ê³„',
      'ğŸ¥ ëª¸ê³¼ ê±´ê°•', 'ğŸ’¼ ì¼ê³¼ í™œë™', 'ğŸµ ê¸°ì¨ê³¼ ì¦ê±°ì›€',
      'ğŸ˜” í˜ë“¤ì—ˆë˜ ë‚ ', 'âœ¨ ê¸°íƒ€'
    ],
    emotions: [
      'ğŸ˜Š ê¸°ì¨', 'ğŸ˜¢ ìŠ¬í””', 'ğŸ’ª ì˜ì§€', 'ğŸ˜° ë¶ˆì•ˆ',
      'ğŸŒ¸ ê°ì‚¬', 'ğŸ’« í¬ë§', 'ğŸ˜” ì™¸ë¡œì›€', 'ğŸ‰ ì„¤ë ˜',
      'ğŸ™ ë°”ëŒ', 'ğŸ˜¤ ì–µìš¸í•¨'
    ]
  },

  /* â”€â”€ ì¥ì• ì¸ ìë…€ë¥¼ ë‘” ë¶€ëª¨ â”€â”€ */
  parent: {
    appName: 'ìš°ë¦¬ ì•„ì´ ì´ì•¼ê¸°',
    channel: 'ë¶€ëª¨ ì‚¬ì—° ì±„ë„',
    themeColor: '#2e8b6e',
    c1: '#2e8b6e',
    c1Light: '#4db896',
    c1Pale: '#edf9f5',
    c1Rgb: '46,139,110',
    ink: '#1a3a2e',
    muted: '#5a8878',
    border: '#c8e8df',

    heroLabel: 'Our Story',
    heroTitle: 'ìš°ë¦¬ ì•„ì´ ì´ì•¼ê¸°ë¥¼',
    heroEm: 'ë‚˜ëˆ ì£¼ì„¸ìš”',
    heroDesc: 'ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” í•˜ë£¨í•˜ë£¨,\nê·¸ ì†Œì¤‘í•œ ìˆœê°„ë“¤ì„ ë“¤ë ¤ì£¼ì„¸ìš”.',

    channel_badge: 'ìš°ë¦¬ ì•„ì´ ì´ì•¼ê¸°',
    name_label: 'ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„',
    tag_card_title: 'ğŸ·ï¸ ì´ì•¼ê¸° ë¶„ë¥˜',
    text_placeholder: 'ìš°ë¦¬ ì•„ì´ì™€ ìˆì—ˆë˜ ì´ì•¼ê¸°, ê¸°ìœ ë‚ ë„ í˜ë“  ë‚ ë„ ëª¨ë‘ ì†Œì¤‘í•´ìš”.\n\në§ˆìŒê» ì¨ì£¼ì„¸ìš”. í•¨ê»˜ ì½ê² ìŠµë‹ˆë‹¤.',
    submit_label: 'ì´ì•¼ê¸° ë³´ë‚´ê¸°',
    success_icon: 'ğŸŒ¿',
    success_title: 'ì´ì•¼ê¸°ê°€ ì „í•´ì¡Œì–´ìš”',
    success_desc: 'ì†Œì¤‘í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.\në°©ì†¡ì„ í†µí•´ ë§ì€ ë¶„ë“¤ê»˜ ì „í• ê²Œìš” ğŸŒ±',

    categories: [
      'ğŸŒŸ ì•„ì´ì˜ ì„±ì¥', 'ğŸ’• í•¨ê»˜í•œ ìˆœê°„', 'ğŸ« êµìœ¡ê³¼ ì¹˜ë£Œ',
      'ğŸ˜… í˜ë“¤ì—ˆë˜ ë‚ ', 'ğŸ‰ ì‘ì€ ê¸°ì ', 'ğŸ¤² ë„ì›€ê³¼ ì§€ì›',
      'ğŸŒˆ ê¿ˆê³¼ ë°”ëŒ', 'âœ¨ ê¸°íƒ€'
    ],
    emotions: [
      'ğŸ¥° ë¿Œë“¯í•¨', 'ğŸ˜¢ ëˆˆë¬¼', 'ğŸ’ª í˜ëƒ„', 'ğŸ˜° ê±±ì •',
      'ğŸŒ¸ ê°ì‚¬', 'ğŸ’« í¬ë§', 'ğŸ˜” ì§€ì¹¨', 'ğŸ‰ ê¸°ì¨',
      'ğŸ™ ë°”ëŒ', 'â¤ï¸ ì‚¬ë‘'
    ]
  },

  /* â”€â”€ ì¥ì• ì¸ í™œë™ì§€ì›ì‚¬ â”€â”€ */
  helper: {
    appName: 'í˜„ì¥ì˜ ëª©ì†Œë¦¬',
    channel: 'í™œë™ì§€ì›ì‚¬ ì±„ë„',
    themeColor: '#1d6fa8',
    c1: '#1d6fa8',
    c1Light: '#4a96cc',
    c1Pale: '#eaf4fb',
    c1Rgb: '29,111,168',
    ink: '#0f2d42',
    muted: '#4a7a99',
    border: '#c2dff0',

    heroLabel: 'Field Voice',
    heroTitle: 'í˜„ì¥ì˜ ëª©ì†Œë¦¬ë¥¼',
    heroEm: 'ë“¤ë ¤ì£¼ì„¸ìš”',
    heroDesc: 'ë§¤ì¼ì˜ í™œë™ í˜„ì¥ì—ì„œ\nëŠë¼ê³  ê²½í—˜í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”.',

    channel_badge: 'í˜„ì¥ì˜ ëª©ì†Œë¦¬',
    name_label: 'ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„',
    tag_card_title: 'ğŸ·ï¸ ì´ì•¼ê¸° ë¶„ë¥˜',
    text_placeholder: 'í™œë™ í˜„ì¥ì—ì„œ ìˆì—ˆë˜ ì¼, ê°ë™ì ì¸ ìˆœê°„, í˜ë“¤ì—ˆë˜ ê²½í—˜...\n\nì—¬ëŸ¬ë¶„ì˜ ëª©ì†Œë¦¬ê°€ ì†Œì¤‘í•©ë‹ˆë‹¤.',
    submit_label: 'ëª©ì†Œë¦¬ ì „ì†¡í•˜ê¸°',
    success_icon: 'ğŸ™ï¸',
    success_title: 'ëª©ì†Œë¦¬ê°€ ì „í•´ì¡ŒìŠµë‹ˆë‹¤',
    success_desc: 'í˜„ì¥ì˜ ì†Œì¤‘í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.\në°©ì†¡ì„ í†µí•´ ë§ì€ ë¶„ë“¤ê»˜ ì „í•˜ê² ìŠµë‹ˆë‹¤ ğŸ“¡',

    categories: [
      'ğŸ¤ í™œë™ ì—í”¼ì†Œë“œ', 'ğŸ’¡ ëŠë‚€ ì ', 'ğŸ˜Š ê°ë™ ìˆœê°„',
      'ğŸ˜“ ì–´ë ¤ìš´ ìˆœê°„', 'ğŸ’¼ ì—…ë¬´ ì´ì•¼ê¸°', 'ğŸŒ¿ ì„±ì¥ê³¼ ë³´ëŒ',
      'ğŸ—£ï¸ í•˜ê³  ì‹¶ì€ ë§', 'âœ¨ ê¸°íƒ€'
    ],
    emotions: [
      'ğŸ˜Š ë³´ëŒ', 'ğŸ˜¢ ì•ˆíƒ€ê¹Œì›€', 'ğŸ’ª ì˜ì§€', 'ğŸ˜° ê±±ì •',
      'ğŸŒ¸ ê°ì‚¬', 'ğŸ’« ë³´ëŒì°¸', 'ğŸ˜” ì§€ì¹¨', 'ğŸ‰ ë¿Œë“¯í•¨',
      'ğŸ™ ë°”ëŒ', 'ğŸ˜¤ ë‹µë‹µí•¨'
    ]
  },

  /* â”€â”€ ì¹˜ë§¤ ë¶€ëª¨ë¥¼ ëª¨ì‹œëŠ” ìë…€ â”€â”€ */
  care: {
    appName: 'ê³ì— ìˆìŠµë‹ˆë‹¤',
    channel: 'ê°€ì¡± ëŒë´„ ì±„ë„',
    themeColor: '#c47c2b',
    c1: '#c47c2b',
    c1Light: '#e0a055',
    c1Pale: '#fdf5ea',
    c1Rgb: '196,124,43',
    ink: '#3d2a10',
    muted: '#9a7a50',
    border: '#f0dfc0',

    heroLabel: 'Care Story',
    heroTitle: 'ê³ì—ì„œ í•¨ê»˜í•˜ëŠ”',
    heroEm: 'ì´ì•¼ê¸°',
    heroDesc: 'ë¶€ëª¨ë‹˜ì„ ëŒë³´ë©° ê²ªëŠ” ì†Œì¤‘í•œ ìˆœê°„ë“¤,\nê·¸ ë§ˆìŒì„ ë‚˜ëˆ ì£¼ì„¸ìš”.',

    channel_badge: 'ê°€ì¡± ëŒë´„ ì´ì•¼ê¸°',
    name_label: 'ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„',
    tag_card_title: 'ğŸ·ï¸ ì´ì•¼ê¸° ë¶„ë¥˜',
    text_placeholder: 'ë¶€ëª¨ë‹˜ê³¼ í•¨ê»˜í•œ í•˜ë£¨, ê¸°ì–µì— ë‚¨ëŠ” ë§ í•œë§ˆë””, í˜ë“¤ì—ˆì§€ë§Œ ì˜ë¯¸ ìˆì—ˆë˜ ìˆœê°„...\n\në§ˆìŒì† ì´ì•¼ê¸°ë¥¼ ì „í•´ì£¼ì„¸ìš”.',
    submit_label: 'ë§ˆìŒ ì „í•˜ê¸°',
    success_icon: 'ğŸŒ»',
    success_title: 'ë§ˆìŒì´ ì „í•´ì¡Œì–´ìš”',
    success_desc: 'ì†Œì¤‘í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.\nì—¬ëŸ¬ë¶„ì˜ ë§ˆìŒì„ ë°©ì†¡ì—ì„œ ì†Œì¤‘íˆ ì „í•˜ê² ìŠµë‹ˆë‹¤ ğŸ§¡',

    categories: [
      'ğŸ’› í•¨ê»˜í•œ í•˜ë£¨', 'ğŸŒ™ ê¸°ì–µ ì†ì˜ ìˆœê°„', 'ğŸ’¬ ë¶€ëª¨ë‹˜ì˜ í•œë§ˆë””',
      'ğŸ˜” í˜ë“¤ì—ˆë˜ ë‚ ', 'ğŸŒ¸ ì‘ì€ í–‰ë³µ', 'ğŸ¥ ëŒë´„ ì´ì•¼ê¸°',
      'ğŸ™ ê°ì‚¬ì™€ ê·¸ë¦¬ì›€', 'âœ¨ ê¸°íƒ€'
    ],
    emotions: [
      'â¤ï¸ ì‚¬ë‘', 'ğŸ˜¢ ìŠ¬í””', 'ğŸ’ª í˜ëƒ„', 'ğŸ˜° ì§€ì¹¨',
      'ğŸŒ¸ ê°ì‚¬', 'ğŸ’« í¬ë§', 'ğŸ˜” ì™¸ë¡œì›€', 'ğŸ¥° ë­‰í´í•¨',
      'ğŸ™ ê·¸ë¦¬ì›€', 'ğŸ˜Š ë”°ëœ»í•¨'
    ]
  }
};
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ê³µí†µ ê¸°ëŠ¥ ë¡œì§
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ URL íŒŒë¼ë¯¸í„°ì—ì„œ íƒ€ì… ì¶”ì¶œ â”€â”€â”€ */
function getType(){
  const params = new URLSearchParams(window.location.search);
  const t = (params.get('type') || '').toLowerCase();
  return TYPES[t] ? t : 'self'; // ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
}

/* â”€â”€â”€ í…Œë§ˆ ì ìš© â”€â”€â”€ */
function applyTheme(cfg){
  const r = document.documentElement.style;
  r.setProperty('--c1', cfg.c1);
  r.setProperty('--c1-light', cfg.c1Light);
  r.setProperty('--c1-pale', cfg.c1Pale);
  r.setProperty('--c1-rgb', cfg.c1Rgb);
  r.setProperty('--ink', cfg.ink);
  r.setProperty('--muted', cfg.muted);
  r.setProperty('--border', cfg.border);

  document.getElementById('meta-theme-color').content = cfg.themeColor;
  document.getElementById('meta-app-title').content = cfg.appName;
  document.getElementById('page-title').textContent = cfg.appName + ' â€” ë¼ë””ì˜¤';
}

/* â”€â”€â”€ ì½˜í…ì¸  ì£¼ì… â”€â”€â”€ */
function applyContent(cfg){
  document.getElementById('channel-badge').textContent = cfg.channel_badge;
  document.getElementById('hero-label').textContent = cfg.heroLabel;
  document.getElementById('hero-title').childNodes[0].textContent = cfg.heroTitle + ' ';
  document.getElementById('hero-em').textContent = cfg.heroEm;
  document.getElementById('hero-desc').innerHTML = cfg.heroDesc.replace(/\n/g,'<br>');

  document.getElementById('label-name').textContent = cfg.name_label;
  document.getElementById('tag-card-title').innerHTML = cfg.tag_card_title;
  document.getElementById('text-card-title').textContent = cfg.text_placeholder.split('\n')[0].substring(0,8) + '...';

  // textarea placeholder
  document.getElementById('f-text').placeholder = cfg.text_placeholder;

  // ì„±ê³µ í™”ë©´
  document.getElementById('success-icon').textContent = cfg.success_icon;
  document.getElementById('success-title').textContent = cfg.success_title;
  document.getElementById('success-desc').innerHTML = cfg.success_desc.replace(/\n/g,'<br>');
  document.getElementById('submit-label').textContent = cfg.submit_label;

  // ì¹´í…Œê³ ë¦¬ íƒœê·¸
  const catEl = document.getElementById('cat-tags');
  catEl.innerHTML = '';
  cfg.categories.forEach(c => {
    const span = document.createElement('span');
    span.className = 'tag';
    span.textContent = c;
    span.onclick = () => selectCat(span);
    catEl.appendChild(span);
  });

  // ê°ì • íƒœê·¸
  const emoEl = document.getElementById('emo-tags');
  emoEl.innerHTML = '';
  cfg.emotions.forEach(e => {
    const span = document.createElement('span');
    span.className = 'tag';
    span.textContent = e;
    span.onclick = () => toggleEmo(span);
    emoEl.appendChild(span);
  });
}

/* â”€â”€â”€ ì´ˆê¸°í™” â”€â”€â”€ */
const TYPE_KEY = getType();
const CFG = TYPES[TYPE_KEY];
applyTheme(CFG);
applyContent(CFG);

/* â”€â”€â”€ ìƒíƒœ ë³€ìˆ˜ â”€â”€â”€ */
let selCat='', selEmos=[];
let recorder=null, chunks=[], recBlob=null, uploadedFile=null;
let timerInt=null, secs=0, recActive=false;
let recognition=null, recognizing=false, sttSecs=0, sttTimer=null;

/* â”€â”€â”€ ìœ í‹¸ â”€â”€â”€ */
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2500);
}

/* â”€â”€â”€ íƒœê·¸ ì„ íƒ â”€â”€â”€ */
function selectCat(el){
  document.querySelectorAll('#cat-tags .tag').forEach(t=>t.classList.remove('active'));
  el.classList.add('active'); selCat=el.textContent.trim();
}
function toggleEmo(el){
  el.classList.toggle('active');
  const t=el.textContent.trim();
  if(el.classList.contains('active')) selEmos.push(t);
  else selEmos=selEmos.filter(e=>e!==t);
}

/* â”€â”€â”€ ë°›ì•„ì“°ê¸° â”€â”€â”€ */
function addSpacing(prev,next){
  if(!prev) return next;
  if(prev.endsWith(' ')||prev.endsWith('\n')) return prev+next;
  if(/[.!?ã€‚]$/.test(prev)) return prev+'\n'+next;
  return prev+' '+next;
}

function toggleSTT(){
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SR){document.getElementById('stt-status').textContent='â— ì´ ë¸Œë¼ìš°ì €ëŠ” ë°›ì•„ì“°ê¸°ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ìš”';return;}
  if(!recognizing){
    recognizing=true;
    const btn=document.getElementById('stt-btn');
    btn.style.background='var(--c1)'; btn.style.color='#fff'; btn.style.borderColor='var(--c1)';
    document.getElementById('stt-label').textContent='ë°›ì•„ì“°ê¸° ì¤‘ì§€';
    document.getElementById('stt-timer').style.display='inline';
    document.getElementById('stt-status').textContent='ğŸ”´ ë“£ê³  ìˆì–´ìš”...';
    sttSecs=0;
    sttTimer=setInterval(()=>{
      sttSecs++;
      document.getElementById('stt-timer').textContent=
        String(Math.floor(sttSecs/60)).padStart(2,'0')+':'+String(sttSecs%60).padStart(2,'0');
    },1000);
    startSTT();
  } else {
    recognizing=false;
    if(recognition){try{recognition.stop();}catch(e){} recognition=null;}
    clearInterval(sttTimer);
    const btn=document.getElementById('stt-btn');
    btn.style.background=''; btn.style.color=''; btn.style.borderColor='';
    document.getElementById('stt-label').textContent='ë°›ì•„ì“°ê¸° ì‹œì‘';
    document.getElementById('stt-timer').style.display='none';
    document.getElementById('stt-status').textContent='âœ… ë°›ì•„ì“°ê¸° ì™„ë£Œ';
  }
}

function startSTT(){
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  recognition=new SR();
  recognition.lang='ko-KR'; recognition.continuous=false; recognition.interimResults=true;
  let base=document.getElementById('f-text').value;
  recognition.onresult=(e)=>{
    let interim='';
    for(let i=e.resultIndex;i<e.results.length;i++){
      if(e.results[i].isFinal){
        base=addSpacing(base,e.results[i][0].transcript.trim());
      } else { interim=e.results[i][0].transcript; }
    }
    document.getElementById('f-text').value=base+(interim?' '+interim:'');
  };
  recognition.onend=()=>{
    if(recognizing){
      base=document.getElementById('f-text').value.trimEnd();
      try{recognition.start();}catch(e){startSTT();}
    }
  };
  recognition.onerror=(e)=>{
    if(e.error==='no-speech'&&recognizing){
      try{recognition.start();}catch(err){startSTT();}
    } else if(e.error==='not-allowed'){
      document.getElementById('stt-status').textContent='â— ë§ˆì´í¬ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤';
      recognizing=false;
    }
  };
  try{recognition.start();}catch(e){}
}

/* â”€â”€â”€ ìŒì„± ë…¹ìŒ â”€â”€â”€ */
async function toggleRec(){
  if(!recActive){
    try{
      const stream=await navigator.mediaDevices.getUserMedia({audio:true});
      recorder=new MediaRecorder(stream); chunks=[];
      recorder.ondataavailable=e=>chunks.push(e.data);
      recorder.onstop=()=>{
        recBlob=new Blob(chunks,{type:'audio/webm'});
        const url=URL.createObjectURL(recBlob);
        document.getElementById('audio-preview').innerHTML=`<audio controls src="${url}"></audio>`;
        stream.getTracks().forEach(t=>t.stop());
      };
      recorder.start(); recActive=true;
      document.getElementById('rec-btn').classList.add('recording');
      document.getElementById('rec-label').textContent='ë…¹ìŒ ì¤‘ì§€';
      secs=0; document.getElementById('rec-timer').style.display='inline';
      timerInt=setInterval(()=>{
        secs++;
        document.getElementById('rec-timer').textContent=
          String(Math.floor(secs/60)).padStart(2,'0')+':'+String(secs%60).padStart(2,'0');
      },1000);
    }catch(e){alert('ë§ˆì´í¬ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');}
  } else {
    recorder.stop(); recActive=false; clearInterval(timerInt);
    document.getElementById('rec-btn').classList.remove('recording');
    document.getElementById('rec-label').textContent='ë…¹ìŒ ì‹œì‘';
    document.getElementById('rec-timer').style.display='none';
  }
}

function handleFile(input){
  const f=input.files[0]; if(!f) return;
  uploadedFile=f; document.getElementById('fname').textContent='âœ… '+f.name;
}

/* â”€â”€â”€ ì œì¶œ â”€â”€â”€ */
async function submitStory(){
  const text=document.getElementById('f-text').value.trim();
  if(!text&&!recBlob&&!uploadedFile){showToast('â— í…ìŠ¤íŠ¸ ë˜ëŠ” ìŒì„± ì‚¬ì—°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');return;}
  const btn=document.getElementById('submit-btn');
  btn.disabled=true; btn.innerHTML='<div class="spinner"></div> ì „ì†¡ ì¤‘...';
  const fd=new FormData();
  fd.append('name',document.getElementById('f-name').value.trim()||'ìµëª…');
  fd.append('contact',document.getElementById('f-contact').value.trim());
  fd.append('text',text); fd.append('category',selCat);
  fd.append('emotions',JSON.stringify(selEmos));
  fd.append('audience_type', TYPE_KEY);   // â† íƒ€ì… ì •ë³´ë„ í•¨ê»˜ ì €ì¥
  const vs=recBlob||uploadedFile;
  if(vs){const ext=vs instanceof File?vs.name.split('.').pop():'webm'; fd.append('voice',vs,`voice.${ext}`);}
  try{
    const res=await fetch('/api/stories',{method:'POST',body:fd});
    const data=await res.json();
    if(data.success){
      document.getElementById('form-body').style.display='none';
      document.getElementById('success-screen').style.display='block';
      window.scrollTo({top:0,behavior:'smooth'});
    }else{
      showToast('â— '+(data.error||'ì˜¤ë¥˜'));
      btn.disabled=false;
      btn.innerHTML=`<span>${CFG.submit_label}</span> âœ‰ï¸`;
    }
  }catch(e){
    showToast('â— ì„œë²„ ì—°ê²° ì‹¤íŒ¨');
    btn.disabled=false;
    btn.innerHTML=`<span>${CFG.submit_label}</span> âœ‰ï¸`;
  }
}

/* â”€â”€â”€ í¼ ë¦¬ì…‹ â”€â”€â”€ */
function resetForm(){
  ['f-text','f-name','f-contact'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('audio-preview').innerHTML='';
  document.getElementById('fname').textContent='';
  document.querySelectorAll('.tag').forEach(t=>t.classList.remove('active'));
  selCat=''; selEmos=[]; recBlob=null; uploadedFile=null;
  const btn=document.getElementById('submit-btn');
  btn.disabled=false; btn.innerHTML=`<span>${CFG.submit_label}</span> âœ‰ï¸`;
  document.getElementById('form-body').style.display='block';
  document.getElementById('success-screen').style.display='none';
  window.scrollTo({top:0,behavior:'smooth'});
}
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PWA / ì„¤ì¹˜ ì•ˆë‚´
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
if('serviceWorker' in navigator){
  window.addEventListener('load',()=>{
    navigator.serviceWorker.register('/service-worker.js');
  });
}
function showTab(tab){
  document.getElementById('tab-android').style.display=tab==='android'?'flex':'none';
  document.getElementById('tab-ios').style.display=tab==='ios'?'flex':'none';
  document.querySelectorAll('.install-tab').forEach((t,i)=>{
    t.classList.toggle('active',(tab==='android'&&i===0)||(tab==='ios'&&i===1));
  });
}
function closeInstallGuide(skip=false){
  document.getElementById('install-guide').classList.remove('show');
  if(skip) localStorage.setItem('install-skip','1');
}
window.addEventListener('load',()=>{
  const isInstalled=window.matchMedia('(display-mode: standalone)').matches;
  let isSkipped=false;
  try{isSkipped=localStorage.getItem('install-skip')==='1';}catch(e){}
  if(!isInstalled&&!isSkipped){
    setTimeout(()=>{
      const el=document.getElementById('install-guide');
      if(el) el.classList.add('show');
    },2000);
  }
});
window.addEventListener('appinstalled',()=>closeInstallGuide());
</script>

<!-- ì„¤ì¹˜ ì•ˆë‚´ íŒì—… -->
<div id="install-guide">
  <div class="install-card">
    <h3>ğŸ“± ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ê¸°</h3>
    <p class="sub">í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ë©´ ì•±ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”</p>
    <div class="install-tabs">
      <button class="install-tab active" onclick="showTab('android')">ğŸ¤– ì•ˆë“œë¡œì´ë“œ</button>
      <button class="install-tab" onclick="showTab('ios')">ğŸ ì•„ì´í°</button>
    </div>
    <div id="tab-android" class="install-steps">
      <div class="install-step">
        <div class="step-num">1</div>
        <div class="step-text"><strong>í¬ë¡¬</strong>ìœ¼ë¡œ ì´ í˜ì´ì§€ë¥¼ ì—´ì–´ì£¼ì„¸ìš”</div>
      </div>
      <div class="install-step">
        <div class="step-num">2</div>
        <div class="step-text">ì˜¤ë¥¸ìª½ ìƒë‹¨ <strong>â‹® ë©”ë‰´</strong>ë¥¼ íƒ­í•˜ì„¸ìš”</div>
      </div>
      <div class="install-step">
        <div class="step-num">3</div>
        <div class="step-text"><strong>"í™ˆ í™”ë©´ì— ì¶”ê°€"</strong> ë˜ëŠ” <strong>"ì•± ì„¤ì¹˜"</strong>ë¥¼ íƒ­í•˜ì„¸ìš”</div>
      </div>
    </div>
    <div id="tab-ios" class="install-steps" style="display:none">
      <div class="install-step">
        <div class="step-num">1</div>
        <div class="step-text"><strong>ì‚¬íŒŒë¦¬</strong>ë¡œ ì´ í˜ì´ì§€ë¥¼ ì—´ì–´ì£¼ì„¸ìš”</div>
      </div>
      <div class="install-step">
        <div class="step-num">2</div>
        <div class="step-text">í•˜ë‹¨ <strong>ê³µìœ  ë²„íŠ¼ â–¡â†‘</strong>ì„ íƒ­í•˜ì„¸ìš”</div>
      </div>
      <div class="install-step">
        <div class="step-num">3</div>
        <div class="step-text"><strong>"í™ˆ í™”ë©´ì— ì¶”ê°€"</strong>ë¥¼ íƒ­í•˜ì„¸ìš”</div>
      </div>
    </div>
    <button class="install-close" onclick="closeInstallGuide()">í™•ì¸í–ˆì–´ìš”!</button>
    <span class="install-skip" onclick="closeInstallGuide(true)">ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°</span>
  </div>
</div>

<footer style="text-align:center;padding:2rem 1rem;font-size:0.75rem;color:var(--muted);">
  <a href="/privacy" style="color:var(--muted);">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
</footer>
</body>
</html>
